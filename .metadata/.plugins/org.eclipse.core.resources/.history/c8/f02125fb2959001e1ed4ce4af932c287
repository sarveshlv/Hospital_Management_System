package com.hms.bookingms.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import com.hms.bookingms.dto.AddBookingRequest;
import com.hms.bookingms.entities.Booking;
import com.hms.bookingms.exceptions.BookingNotFoundException;
import com.hms.bookingms.exceptions.HospitalNotFoundException;
import com.hms.bookingms.exceptions.InvalidBookingRequest;
import com.hms.bookingms.exceptions.InvalidDatesException;
import com.hms.bookingms.exceptions.PatientNotFoundException;
import com.hms.bookingms.service.BookingService;

import jakarta.validation.Valid;

import java.util.List;

@RestController
@RequestMapping("/api/bookings")
public class BookingController {

	@Autowired
	private BookingService bookingService;
	
	@PostMapping("/add")
	public Booking addBooking(@Valid @RequestBody AddBookingRequest addBookingRequest)
			throws PatientNotFoundException, HospitalNotFoundException, InvalidDatesException {
		return bookingService.addBooking(addBookingRequest);
	}

	@GetMapping("/find/{bookingId}")
	public Booking getBookingById(@PathVariable String bookingId) throws BookingNotFoundException {
		return bookingService.findBookingById(bookingId);
	}

	@GetMapping("/findByPatientId/{patientId}")
	public List<Booking> getBookingsByPatientId(@PathVariable String patientId) throws PatientNotFoundException {
		return bookingService.getBookingByPatientId(patientId);
	}
	
	@GetMapping("/findByHospitalId/{hospitalId}")
	public List<Booking> getBookingByHospitalId(@PathVariable String hospitalId) throws HospitalNotFoundException{
		return bookingService.getBookingByHospitalId(hospitalId);
	}
	
	@GetMapping("/approve/{bookingId}")
	public Booking approveBooking(@PathVariable String bookingId)
			throws BookingNotFoundException, InvalidBookingRequest {
		return bookingService.approveBooking(bookingId);
	}

	@GetMapping("/reject/{bookingId}")
	public Booking rejectBooking(@PathVariable String bookingId)
			throws BookingNotFoundException, InvalidBookingRequest {
		return bookingService.rejectBooking(bookingId);
	}

	@GetMapping("/cancel/{bookingId}")
	public Booking cancelBooking(@PathVariable String bookingId)
			throws BookingNotFoundException, InvalidBookingRequest {
		return bookingService.cancelBooking(bookingId);
	}

	@GetMapping("/check/{bookingId}")
	public String checkBookingStatus(@PathVariable String bookingId) throws BookingNotFoundException {
		return bookingService.checkBooking(bookingId);
	}
	
}
